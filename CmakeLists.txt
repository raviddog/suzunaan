cmake_minimum_required (VERSION 3.16)
project (test)

file(MAKE_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
set(OUT_DIR ${CMAKE_BINARY_DIR}/bin)
set(IN_RES_DIR ./res)

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ./bin)
#set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ./bin)

add_library(engine STATIC engine/engine_gl.cpp engine/engine.cpp engine/glad.c engine/stb_image.cpp)
target_include_directories(engine PUBLIC ./engine)
target_link_libraries(engine -lmingw32 -lSDL2main -lSDL2)

add_library(game STATIC source/content/menu.cpp source/content/teststage.cpp source/content/player.cpp source/content/bullet.cpp)
target_include_directories(game PUBLIC . ./engine ./source/content)

add_executable(test source/main.cpp source/game.cpp)
target_include_directories(test PUBLIC .)
target_link_libraries(test engine game)
target_link_libraries(test -w -Wl,-subsystem,console)
#target_link_libraries(test -w -Wl,-subsystem,windows)

#target_link_libraries(test -lmingw32 -lSDL2main -lSDL2 -lSDL2_ttf -lSDL2_mixer)

#configure_file(${IN_RES_DIR}/SDL2.dll ${OUT_DIR} COPYONLY)
add_custom_command(TARGET test PRE_BUILD COMMAND ${CMAKE_COMMAND} -E copy_directory "${PROJECT_SOURCE_DIR}/res" $<TARGET_FILE_DIR:test>)